<script type="text/javascript">
  var kompetansemaalRader = <%= @rader.to_json %>

  Ext.onReady(function(){
    Ext.state.Manager.setProvider(new Ext.state.CookieProvider());
    
    // create the data store
    var store = new Ext.data.SimpleStore({
      fields: [
        {name: 'laereplan'},
        {name: 'hovedomraade'},
        {name: 'kompetansemaalsett'},
        {name: 'trinn'},
        {name: 'kompetansemaal_uuid'},
        {name: 'kompetansemaal_kode'},
        {name: 'kompetansemaal'}
      ]
    });
    store.loadData(kompetansemaalRader);

    // create the Grid
    var grid = new Ext.grid.GridPanel({
      id: 'kompetansemaal_grid',
      store: store,
      columns: [
        {header: "Læreplan", sortable: false, dataIndex: 'laereplan'},
        {header: "Hovedomrade", sortable: false, dataIndex: 'hovedomraade'},
        {header: "Kompetansemålsett", sortable: false, dataIndex: 'kompetansemaalsett'},
        {header: "Trinn", sortable: false, dataIndex: 'trinn'},
        {header: "Kompetansemål-uuid", sortable: false, hidden: true, dataIndex: 'kompetansemaal_uuid'},
        {header: "Kompetansemålkode", sortable: false, dataIndex: 'kompetansemaal_kode'},
        {header: "Kompetansemål", sortable: false, dataIndex: 'kompetansemaal'}
        ],
        stripeRows: true,
        height: 500,
        title:'Kompetansemål'
      });
      
      grid.addButton( {
        text: 'Kopier til utklippstavle',
        clickEvent: 'ctrl-c',
        handler : function(){
                      copySelectedUuids();
                  }
        });



      grid.render('kompetansemaal');
      grid.getSelectionModel().selectFirstRow();

      // action listener
      grid.addListener
      (
        'keydown', 
        function(evnt)
        {
          var keyPressed = evnt.getKey();

          if (evnt.ctrlKey) {
            /*
            * ctrl+c combination is code 67 
            */
            if (keyPressed == 67)
              {
                copySelectedUuids();
              }
            }
          }
        );
        //end of action listener
    
    });
      
 </script>



<link rel="stylesheet" type="text/css" href="http://extjs.com/deploy/dev/examples/grid/grid-examples.css"/>
<link rel="stylesheet" type="text/css" href="http://extjs.com/deploy/dev/examples/grid/../shared/lib.css" />
<link rel="stylesheet" type="text/css" href="http://extjs.com/deploy/dev/examples/grid/../../resources/css/ext-all.css" />

<div id="antall_treff" style="display:none;" ><%= @kompetansemaal.length%></div>

<div id="kompetansemaal" style="height: 500px"> </div>


<% unless @rader.empty? %>
  <%= will_paginate @rader %>
<% end %>

<%#= button_to_function "Kopier til utklippstavle", "getSelectedUuids()" %>
  
  